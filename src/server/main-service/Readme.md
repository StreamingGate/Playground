# Main-Serivce
일반 영상, 라이브에서 공통으로 사용되는 기능, 친구 기능을 모아둔 API입니다.

# 사용 기술
* Spring boot 2.6
* MariaDB

# API
* 일반 영상과 라이브 카테고리별 조회 (무한 스크롤)
* 특정 유저에게 저장된 알림 리스트 조회
* 친구 리스트 조회
* 친구 요청, 삭제
* 친구 요청 대기 리스트 조회
* 친구 요청 수락, 거절
* 일반 영상 또는 라이브에 반응하기, 취소하기 (반응: 좋아요, 싫어요, 신고하기)

# 서버 실행시 필요한 yml
없음


---
# 단위 테스트 코드 작성시 깨달은 것(서비스 층) :
- 결과마저 내가 더미데이터로 만들어주면 된다는 것을 알았다.
- mocking이 좀 헷갈렸다. 특히 static method(PowerMock사용), void method에서 mocking이 어려웠다.
- 실제 동작과 관계없이 `@SpyBean`, `@InjectMocks`을 이용해 서비스 층 내에서 동작을 검증할 수 있었다.
- stub을 만들어서 수 있어서 restTemplate(채팅서버에 요청)생략할 수 있었다.

### 참고
`@DataJpaTest`
```yaml
* JPA 관련 테스트 설정만 로드.
* 데이터소스의 설정이 정상적인지 테스트.
* JPA를 사용하여 데이터를 제대로 생성, 수정 삭제하는지 등의 테스트.
* 내장형 데이터베이스를 사용하여 실제 데이터베이스를 사용하지 않고 테스트 데이터 베이스로 테스트할 수 있음.
* @DataJpaTest는 기본적으로 @Transactional 어노테이션을 포함하고 있어 테스트가 완료되면 자동으로 롤백함.
```
